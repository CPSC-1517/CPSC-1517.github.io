<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CPSC-1517 Student Notes</title>
    <meta name="description" content="Introduction to Application Development">
    
    
    <link rel="preload" href="/assets/css/0.styles.80f4b4fc.css" as="style"><link rel="preload" href="/assets/js/app.b01b77a3.js" as="script"><link rel="preload" href="/assets/js/3.7fdc53a7.js" as="script"><link rel="prefetch" href="/assets/js/16.65ca882c.js"><link rel="prefetch" href="/assets/js/1.8ec5c8e9.js"><link rel="prefetch" href="/assets/js/2.3ed57d20.js"><link rel="prefetch" href="/assets/js/4.3ae5e10c.js"><link rel="prefetch" href="/assets/js/5.4f61ad78.js"><link rel="prefetch" href="/assets/js/6.e9856ce1.js"><link rel="prefetch" href="/assets/js/7.545742b1.js"><link rel="prefetch" href="/assets/js/8.f5420ce6.js"><link rel="prefetch" href="/assets/js/9.57aecd33.js"><link rel="prefetch" href="/assets/js/10.ec6ae9c3.js"><link rel="prefetch" href="/assets/js/11.f57f4b4c.js"><link rel="prefetch" href="/assets/js/12.b1eb4f61.js"><link rel="prefetch" href="/assets/js/13.3aa1d2e6.js"><link rel="prefetch" href="/assets/js/14.e130c5b8.js"><link rel="prefetch" href="/assets/js/15.68dc8e9d.js"><link rel="prefetch" href="/assets/js/17.295eeab3.js"><link rel="prefetch" href="/assets/js/18.db61e7e8.js"><link rel="prefetch" href="/assets/js/19.2ea1010b.js"><link rel="prefetch" href="/assets/js/20.f4159ad9.js"><link rel="prefetch" href="/assets/js/21.b6c17dd6.js"><link rel="prefetch" href="/assets/js/22.9919b407.js"><link rel="prefetch" href="/assets/js/23.b0bbc267.js"><link rel="prefetch" href="/assets/js/24.046a81c3.js"><link rel="prefetch" href="/assets/js/25.6a9003d0.js"><link rel="prefetch" href="/assets/js/26.b6d3cee7.js"><link rel="prefetch" href="/assets/js/27.97f57c46.js"><link rel="prefetch" href="/assets/js/28.c6e59545.js"><link rel="prefetch" href="/assets/js/29.809ebd4f.js"><link rel="prefetch" href="/assets/js/30.dc025023.js"><link rel="prefetch" href="/assets/js/31.69b7baf3.js"><link rel="prefetch" href="/assets/js/32.3260e839.js"><link rel="prefetch" href="/assets/js/33.81770332.js"><link rel="prefetch" href="/assets/js/34.9f535d6f.js"><link rel="prefetch" href="/assets/js/35.82a8321e.js"><link rel="prefetch" href="/assets/js/36.ec46a592.js"><link rel="prefetch" href="/assets/js/37.41b49598.js"><link rel="prefetch" href="/assets/js/38.e6a94cc0.js"><link rel="prefetch" href="/assets/js/39.ea64a9f0.js"><link rel="prefetch" href="/assets/js/40.83ee11d7.js"><link rel="prefetch" href="/assets/js/41.ae514a7e.js"><link rel="prefetch" href="/assets/js/42.8765a0e8.js"><link rel="prefetch" href="/assets/js/43.d7d929c7.js"><link rel="prefetch" href="/assets/js/44.07e3c5a8.js"><link rel="prefetch" href="/assets/js/45.95a7025f.js"><link rel="prefetch" href="/assets/js/46.21e7da18.js"><link rel="prefetch" href="/assets/js/47.5812101f.js"><link rel="prefetch" href="/assets/js/48.fd9df22d.js"><link rel="prefetch" href="/assets/js/49.c89b76ea.js"><link rel="prefetch" href="/assets/js/50.0be0d56d.js"><link rel="prefetch" href="/assets/js/51.57c20bfa.js"><link rel="prefetch" href="/assets/js/52.625a4d89.js"><link rel="prefetch" href="/assets/js/53.5270efde.js"><link rel="prefetch" href="/assets/js/54.5e7698cf.js"><link rel="prefetch" href="/assets/js/55.9cacbf77.js"><link rel="prefetch" href="/assets/js/56.830da2e5.js"><link rel="prefetch" href="/assets/js/57.8591b9ad.js"><link rel="prefetch" href="/assets/js/58.7df31f10.js"><link rel="prefetch" href="/assets/js/59.ab6b1148.js"><link rel="prefetch" href="/assets/js/60.f727eddd.js"><link rel="prefetch" href="/assets/js/61.cbdfa5dd.js"><link rel="prefetch" href="/assets/js/62.5e0cc423.js"><link rel="prefetch" href="/assets/js/63.16a47ba7.js"><link rel="prefetch" href="/assets/js/64.19d9e97e.js"><link rel="prefetch" href="/assets/js/65.8fa23770.js"><link rel="prefetch" href="/assets/js/66.9a17bd87.js"><link rel="prefetch" href="/assets/js/67.189fb768.js"><link rel="prefetch" href="/assets/js/68.4b49cf88.js"><link rel="prefetch" href="/assets/js/69.7f2a1d2c.js"><link rel="prefetch" href="/assets/js/70.8af31878.js"><link rel="prefetch" href="/assets/js/71.17675d86.js"><link rel="prefetch" href="/assets/js/72.bcb2bc7a.js"><link rel="prefetch" href="/assets/js/73.dd17b763.js"><link rel="prefetch" href="/assets/js/74.a6a8cf88.js"><link rel="prefetch" href="/assets/js/75.a2b72aff.js"><link rel="prefetch" href="/assets/js/76.1548e2b3.js"><link rel="prefetch" href="/assets/js/77.48482f97.js"><link rel="prefetch" href="/assets/js/78.1d12e22b.js"><link rel="prefetch" href="/assets/js/79.66410dcd.js"><link rel="prefetch" href="/assets/js/80.5da26b58.js"><link rel="prefetch" href="/assets/js/81.519c61fb.js"><link rel="prefetch" href="/assets/js/82.e7b13c3f.js"><link rel="prefetch" href="/assets/js/83.820b1f6a.js"><link rel="prefetch" href="/assets/js/84.8a818fb3.js"><link rel="prefetch" href="/assets/js/85.f0933f63.js"><link rel="prefetch" href="/assets/js/86.2055e310.js">
    <link rel="stylesheet" href="/assets/css/0.styles.80f4b4fc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      CPSC-1517 Student Notes
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/about/" class="nav-link">Home</a></div><div class="nav-item"><a href="/logs/" class="nav-link">LOGs</a></div><div class="nav-item"><a href="/csharp/" class="nav-link">C-Sharp</a></div><div class="nav-item"><a href="/html/" class="nav-link">Html</a></div><div class="nav-item"><a href="/razor/" class="nav-link">Razor</a></div><div class="nav-item"><a href="/clientserver/" class="nav-link">Client-Server</a></div><div class="nav-item"><a href="/webforms/" class="nav-link router-link-active">Webforms</a></div><div class="nav-item"><a href="https://cpsc-1517.github.io/LabSpecs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lab Specs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/CPSC-1517/CPSC-1517.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about/" class="nav-link">Home</a></div><div class="nav-item"><a href="/logs/" class="nav-link">LOGs</a></div><div class="nav-item"><a href="/csharp/" class="nav-link">C-Sharp</a></div><div class="nav-item"><a href="/html/" class="nav-link">Html</a></div><div class="nav-item"><a href="/razor/" class="nav-link">Razor</a></div><div class="nav-item"><a href="/clientserver/" class="nav-link">Client-Server</a></div><div class="nav-item"><a href="/webforms/" class="nav-link router-link-active">Webforms</a></div><div class="nav-item"><a href="https://cpsc-1517.github.io/LabSpecs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lab Specs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/CPSC-1517/CPSC-1517.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><ul class="sidebar-links"><li><a href="/webforms/" class="sidebar-link">Webforms</a></li><li><a href="/webforms/01-overview.html" class="sidebar-link">Web Forms Overview</a></li><li><a href="/webforms/02-servercontrols.html" class="sidebar-link">Web Form Controls</a></li><li><a href="/webforms/asp-controls-intro.html" class="sidebar-link">Programming with ASP.NET Controls</a></li><li><a href="/webforms/tutorial-2-maptodb.html" class="sidebar-link">Mapping to the Database</a></li></ul></div><div class="page"><div class="content"><p>Using DataBound Controls (Tutorial 7 of 9)<br>
Hands-On Tutorials for Application Programming 1 (DMIT152)<br>
Contents at a Glance<br>
Introduction	1<br>
Using Data Bound Controls	2</p><p>Detailed Contents<br>
Introduction	1<br>
Using Data Bound Controls	2<br>
Setup	2<br>
Part 1 – Prepare the BLL with ComponentModel Attributes	2<br>
Part 2 – Data-Bound GridView	6<br>
Create the Form	6<br>
Part 3 – Data-Bound DropDown and GridView	22<br>
Hooking Up the DropDownList	22<br>
Hooking Up the GridView	25<br>
Making the Form User Friendly	27<br>
Part 4 – TextBox and Data-Bound GridView	34<br>
Summary	36<br>
Discussion Points	36</p><p>Introduction<br>
This series of hands-on tutorials are designed to demonstrate how to build a web application that uses a Client-Server architecture and that persists information in a database. Each tutorial will walk the reader through steps to build upon a specific web application scenario based upon the Northwind Traders database.<br>
There are nine tutorials in this package. Each hands-on tutorial has a Starter Kit folder with all of the required material to begin the tutorial and a Solution folder with the final product of the tutorial.<br>
Using Data Bound Controls<br>
•	Estimated time: 15-30 minutes.<br>
•	Parts:</p><ol><li><p>Part 1 – Prepare the BLL with ComponentModel Attributes</p></li><li><p>Part 2 – Data-Bound GridView<br>
ManageProducts</p></li><li><p>Part 3 – Data-Bound DropDown and GridView<br>
ViewProductsByCategory</p></li><li><p>Part 4 – TextBox and Data-Bound GridView<br>
ViewProductsByPartialNamePurpose<br>
This hands-on tutorial walks through how to enable your Business Logic Layer to support integration with your Presentation Layer in a code-free (or code-light) way through the use of the ObjectDataSource control. The ObjectDataSource control acts as a “middle-man” in exchanging data between your BLL and various Data Bound controls, such as the GridView and DropDownList.<br>
Setup<br>
For this lab, you will need the Visual Studio solution and database from the previous topic(s). The Starter Kit folder contains these resources.<br>
Part 1 – Prepare the BLL with ComponentModel Attributes<br>
In order to simplify the setting up of data bound controls, we can add attributes to the BLL classes and methods that will allow them to be easily “discovered” by the ObjectDataSource controls in our forms. To do this, we will use the DataObject and DataObjectMethod attributes of the ComponentModel namespace.</p></li><li><p>Go to the NorthwindSystem project and open the CategoryController.cs file. Add a using statement at the top of the file to import the System.ComponentModel namespace.<br>
using System.ComponentModel;</p></li><li><p>In order for these BLL methods to be visible to ObjectDataSource controls, we must first make the class visible by adding a DataObject attribute before the class declaration.<br>
[DataObject(true)]<br>
public class CategoryController</p></li><li><p>Next, we add DataObjectMethod attributes to the public methods of the class. When adding these attributes, we declare the kind of service (from a CRUD point of view) that the method provides: Insert, Select, Update, or Delete. We will also indicate whether the method is the default for that particular service.<br>
[DataObjectMethod(DataObjectMethodType.Insert, true)]<br>
public int AddCategory(Category info)<br>
{<br>
return DataProvider.Add(info);<br>
}</p><pre><code>[DataObjectMethod(DataObjectMethodType.Select, true)]
public List&amp;lt;Category&amp;gt; ListAllCategories()
{
    List&amp;lt;Category&amp;gt; categoryList = DataProvider.List();
    return categoryList;
}

[DataObjectMethod(DataObjectMethodType.Select, false)]
public Category LookupCategory(int categoryId)
{
    Category info = DataProvider.Lookup(categoryId);
    return info;
}

[DataObjectMethod(DataObjectMethodType.Update, true)]
public int UpdateCategory(Category info)
{
    return DataProvider.Update(info);
}

[DataObjectMethod(DataObjectMethodType.Delete, true)]
public int DeleteCategory(int categoryId)
{
    return DataProvider.Delete(categoryId);
}
</code></pre></li><li><p>Now open the ProductController class and perform the same kinds of modifications.<br>
a.	Import the System.ComponentModel namespace.<br>
using System.ComponentModel;</p></li></ol><p>b.	Add the DataObject attribute to the class name.<br>
[DataObject(true)]<br>
public class ProductController</p><p>c.	Add DataObjectMethod attributes to the methods.<br>
[DataObjectMethod(DataObjectMethodType.Insert, true)]<br>
public int AddProduct(Product info)<br>
{<br>
return DataProvider.Add(info);<br>
}</p><pre><code>    [DataObjectMethod(DataObjectMethodType.Select, true)]
    public List&amp;lt;Product&amp;gt; ListAllProducts()
    {
        List&amp;lt;Product&amp;gt; productList = DataProvider.List();
        return productList;
    }

    [DataObjectMethod(DataObjectMethodType.Select, false)]
    public Product LookupProduct(int productId)
    {
        Product info = DataProvider.Lookup(productId);
        return info;
    }

    [DataObjectMethod(DataObjectMethodType.Select, false)]
    public List&amp;lt;Product&amp;gt; LookupProductsByName(string partialName)
    {
        return DataProvider.LookupByProductName(partialName);
    }

    [DataObjectMethod(DataObjectMethodType.Select, false)]
    public List&amp;lt;Product&amp;gt; LookupProductsByCategory(int? categoryId)
    {
        return DataProvider.LookupByCategory(categoryId);
    }

    [DataObjectMethod(DataObjectMethodType.Select, false)]
    public List&amp;lt;Product&amp;gt; LookupProductsBySupplier(int? supplierId)
    {
        List&amp;lt;Product&amp;gt; productList = default(List&amp;lt;Product&amp;gt;);
        productList = DataProvider.LookupBySupplier(supplierId);
        return productList;
    }

    [DataObjectMethod(DataObjectMethodType.Update, true)]
    public int UpdateProduct(Product info)
    {
        return DataProvider.Update(info);
    }

    [DataObjectMethod(DataObjectMethodType.Delete, true)]
    public int DeleteProduct(int productId)
    {
        return DataProvider.Delete(productId);
    }
}
</code></pre><p>}</p><ol start="5"><li>Once again, open another BLL class – SupplierController – and make the same kinds of modifications.<br>
using System;<br>
using System.Collections.Generic;<br>
using NorthwindEntities;<br>
using NorthwindSystem.DAL;<br>
using System.ComponentModel;</li></ol><p>namespace NorthwindSystem.BLL<br>
{<br>
public class SupplierController<br>
{<br>
private SupplierProvider DataProvider { get; set; }</p><pre><code>    public SupplierController()
    {
        DataProvider = new SupplierProvider();
    }

    [DataObjectMethod(DataObjectMethodType.Insert, true)]
    public int AddSupplier(Supplier info)
    {
        return DataProvider.Add(info);
    }

    [DataObjectMethod(DataObjectMethodType.Select, true)]
    public List&amp;lt;Supplier&amp;gt; ListAllSuppliers()
    {
        return DataProvider.List();
    }

    [DataObjectMethod(DataObjectMethodType.Select, false)]
    public Supplier LookupSupplier(int supplierId)
    {
        return DataProvider.Lookup(supplierId);
    }

    [DataObjectMethod(DataObjectMethodType.Update, true)]
    public int UpdateSupplier(Supplier info)
    {
        return DataProvider.Update(info);
    }

    [DataObjectMethod(DataObjectMethodType.Delete, true)]
    public int DeleteSupplier(int supplierId)
    {
        return DataProvider.Delete(supplierId);
    }
}
</code></pre><p>}</p><ol start="6"><li>Lastly, it will be necessary to build the project (so that the web site gets a fresh copy of the class library DLL with these code changes). Now these BLL methods are prepared to be hooked up to the ObjectDataSource controls in the following parts of this tutorial.</li></ol><p>Part 2 – Data-Bound GridView<br>
Create the Form</p><ol><li><p>Create a folder under the Admin folder and name it “DataBound”. This is to help distinguish these tutorials, which work with data-bound controls, from earlier tutorials which primarily used code-behind to populate the form’s controls.</p></li><li><p>In the Admin/DataBound folder of the web site, create a new web form called “ManageProducts.aspx”. At the top of the form, place an &lt;h1&gt; element with the text “Manage Products”.</p></li><li><p>Add a GridView control and give it an ID of “ProductsGridView”. Add an ObjectDataSource control and name it ProductDataSource.</p></li><li><p>Click the ProductDataSource’s smart tag and select “Configure Data Source”.</p></li><li><p>Select the NorthwindSystem.BLL.ProductController as the Business Object in the first page of the wizard. Then click “Next”.</p></li><li><p>In the “Define Data Methods” page of the wizard, choose ListAllProducts() as the SELECT method. Then click “Finish”.</p></li><li><p>Click the GridView’s smart tag and select ProductDataSource from the “Choose Data Source” dropdown. Notice how the GridView automatically “discovers” the kind of data (Products) that is supplied by the ObjectDataSource control and then creates columns for each property of the Product class.</p></li><li><p>Test the form in a browser window. All of the products should be laid out in a table.</p></li></ol><p>The GridView’s Columns and Headings</p><ol><li><p>Return to the Design view of the form. Click the GridView’s smart tag and select “Edit Columns…”.</p></li><li><p>In the Fields dialog, click on ProductID from the list of selected fields. Then change the Visible property to False.</p></li><li><p>Click ProductName from the list of selected fields. Then, in the list of properties for this field, change the HeaderText to “Product Name”.</p></li><li><p>Continue modifying the header text of the columns until your GridView looks a follows.</p></li></ol><p>ObjectDataSource for Foreign Key Columns – Category and Supplier</p><ol><li><p>Add two more ObjectDataSource controls to the form. Name them CategoryDataSource and SupplierDataSource.</p></li><li><p>Click the smart tag for the CategoryDataSource and click “Configure Data Source…”.</p></li><li><p>Select the CategoryController as the business objects for the CategoryDataSource. Then click “Next”.</p></li><li><p>Use the ListAllCategories() method as the SELECT method for the CategoryDataSource. Then click “Finish”.</p></li><li><p>Click the smart tag for the SupplierDataSource and click “Configure Data Source…”.</p></li><li><p>Select the SupplierController as the business object for the SupplierDataSource. Then click “Next”.</p></li><li><p>Use the ListAllSuppliers() method as the SELECT method for the SupplierDataSource. Then click “Finish”.</p></li></ol><p>Template Columns for Foreign Keys – CategoryID</p><ol><li><p>Once again, click the GridView’s smart tag and select “Edit Columns…”. This time, select the column for the Category and click the “Convert this field into a TemplateField” link.</p></li><li><p>Select the Supplier column from the selected fields. Convert this field into a TemplateField as well. Then click OK.</p></li><li><p>From the GridView’s smart tag, select “Edit Templates”.</p></li><li><p>Then select the Item Template for the Category.</p></li><li><p>Remove the Label control from the Item Template. Replace it with a DropDownList control and give that control an ID of CategoryItem.</p></li><li><p>Click the smart tag of the DropDownList and select “Choose Data Source…”.</p></li><li><p>In the Data Source Configuration Wizard, select the CategoryDataSource from the drop down. Then select “CategoryName” as the field to display and “CategoryID” as the field for the value of the DropDownList. Click OK.</p></li><li><p>Again, from the smart tag of the DropDownList, click on “Edit DataBindings…”.</p></li><li><p>For the SelectedValue property of the DropDownList, choose Field binding and have it bound to the CategoryID of the GridView’s data. This will allow the DropDownList control in the Category column of the GridView to synchronize its selected item with the actual category for each row in the GridView. Click OK when finished.</p></li><li><p>In the Properties window for the DropDownList, set the AppendDataBoundItems to true. Also set the Enabled property to false and change the ForeColor to “Black”.</p></li><li><p>Choose “Edit Items…” from the smart tag of the DropDownList.</p></li><li><p>Add an item with a display text of “[no category]”. Click OK. Also, save the form at this step, because in the next step we will switch to the Source view, and we don’t want this manual item to be “lost”.</p></li><li><p>Select the Source or Split view of the form. Go to the “[no category]” ListItem for this DropDownList and set the Value attribute to an empty string. We need an empty string value for any Products whose CategoryID property is null.<br>
(Note that this change to the ListItem must actually be done in the source of the web form and not from the ListItem Collection Editor. That’s because if you try to simply empty the Value property in the ListItem Collection Editor, it will remove the Value attribute. This has a different effect from keeping the Value attribute and setting it to an empty string.)<br>
&lt;asp:TemplateField HeaderText=&quot;Category&quot; SortExpression=&quot;CategoryID&quot;&gt;<br>
&lt;EditItemTemplate&gt;<br>
&lt;asp:TextBox ID=&quot;TextBox1&quot; runat=&quot;server&quot; Text='&lt;%# Bind(&quot;CategoryID&quot;) %&gt;'&gt;<br>
&lt;/asp:TextBox&gt;<br>
&lt;/EditItemTemplate&gt;<br>
&lt;ItemTemplate&gt;<br>
&lt;asp:DropDownList ID=&quot;CategoryItem&quot; runat=&quot;server&quot;<br>
AppendDataBoundItems=&quot;True&quot;<br>
DataSourceID=&quot;CategoryDataSource&quot; DataTextField=&quot;CategoryName&quot;<br>
DataValueField=&quot;CategoryID&quot; ForeColor=&quot;Black&quot;<br>
SelectedValue='&lt;%# Bind(&quot;CategoryID&quot;) %&gt;' Enabled=&quot;False&quot;&gt;<br>
&lt;asp:ListItem Value=&quot;&quot;&gt;[no category]&lt;/asp:ListItem&gt;<br>
&lt;/asp:DropDownList&gt;<br>
&lt;/ItemTemplate&gt;<br>
&lt;/asp:TemplateField&gt;</p></li><li><p>Test the form in the browser. Selecting a category of products should fill the GridView with data in a more readable format.</p></li></ol><p>Template Columns for Foreign Keys - SupplierID</p><ol><li><p>Return to editing the templates of the GridView control. This time, edit the TemplateField for the Supplier information to replace the Label control with a DropDownList. Configure it just like the template field for categories, but hook this control up to the SupplierDataSource and bind it to the SupplierID of the GridView.</p><pre><code>        &amp;lt;asp:TemplateField HeaderText=&quot;Supplier&quot; SortExpression=&quot;SupplierID&quot;&amp;gt;
            &amp;lt;EditItemTemplate&amp;gt;
                &amp;lt;asp:TextBox ID=&quot;TextBox2&quot; runat=&quot;server&quot; Text='&amp;lt;%# Bind(&quot;SupplierID&quot;) %&amp;gt;'&amp;gt;
                &amp;lt;/asp:TextBox&amp;gt;
            &amp;lt;/EditItemTemplate&amp;gt;
            &amp;lt;ItemTemplate&amp;gt;
                &amp;lt;asp:DropDownList ID=&quot;SupplierItem&quot; runat=&quot;server&quot;
                    AppendDataBoundItems=&quot;True&quot;
                    AutoPostBack=&quot;True&quot; Enabled=&quot;False&quot; ForeColor=&quot;Black&quot;
                    SelectedValue='&amp;lt;%# Bind(&quot;SupplierID&quot;) %&amp;gt;'
                    DataSourceID=&quot;SupplierDataSource&quot; DataTextField=&quot;CompanyName&quot;
                    DataValueField=&quot;SupplierID&quot;&amp;gt;
                    &amp;lt;asp:ListItem Value=&quot;&quot;&amp;gt;[no supplier]&amp;lt;/asp:ListItem&amp;gt;
                &amp;lt;/asp:DropDownList&amp;gt;
            &amp;lt;/ItemTemplate&amp;gt;
        &amp;lt;/asp:TemplateField&amp;gt;
</code></pre></li><li><p>Test the form in the browser. Selecting a category of products should fill the GridView with data in a format that is more readable to the user.</p></li></ol><p>Part 3 – Data-Bound DropDown and GridView<br>
The goal of this part of the tutorial is to create the following web form that uses absolutely no code-behind. This is achieved through the use of Data Bound controls.</p><p>The steps in this part of the tutorial begin with hooking up an ObjectDataSource to a DropDownList that displays all the categories in the system. Next, another ObjectDataSource is configured and set to supply data to a GridView while responding to the user’s interactions with the DropDownList. Finally, the appearance of the GridView is customized to make it more user-friendly by editing the column headings and displaying meaningful information for properties representing database foreign keys.<br>
Hooking Up the DropDownList</p><ol><li><p>In the Admin/DataBound folder of the web site, create a new web form called “ViewProductsByCategory.aspx”. Design the form to look like the following screen shot. Give the DropDownList an ID of CategoryDropDownList. Also add a LinkButton to the form.</p></li><li><p>Add an ObjectDataSource controls to the form. Give it an ID of CategoryDataSource.</p></li><li><p>Click the smart tag for the CategoryDataSource and select “Configure Data Source”. This will open a wizard control that will simplify hooking up this control to the Business Logic Layer of our application.</p></li><li><p>In the “Choose a Business Object” page of the wizard, make sure the “Show only data components” check box is selected. Choose the NorthwindSystem.BLL.CategoryController class as the Business Object that will supply data for this control. Then click “Next”.</p></li><li><p>In the “Define Data Methods” page of the wizard, select the ListAllCategories() method as the SELECT method for the control. Then click “Finish”.</p></li><li><p>In the design view of the form, click the smart tag of the DropDownList control and click “Choose Data Source…”. This will open the Data Source Configuration Wizard.</p></li><li><p>In the wizard, look for the CategoryDataSource in the drop down under “Select a data source”. Then select “CategoryName” as the “data field to display in the DropDownList”. Select “CategoryID” as the “data field for the value of the DropDownList”. Then click OK.</p></li><li><p>Test the form in the browser.</p></li></ol><p>Hooking Up the GridView</p><ol><li><p>Return to the design view of the form. Add the GridView control and give it an ID of “ProductsGridView”. Add another ObjectDataSource control and name it ProductDataSource.</p></li><li><p>Click the ProductDataSource’s smart tag and select “Configure Data Source”.</p></li><li><p>Select the NorthwindSystem.BLL.ProductController as the Business Object in the first page of the wizard. Then click “Next”.</p></li><li><p>In the “Define Data Methods” page of the wizard, choose LookupProductsByCategory() as the SELECT method. Then click “Next”.</p></li><li><p>In the “Define Parameters” page of the wizard, we must identify the CategoryDropDownList as the control that supplies the value for the CategoryID parameter of the LookupProductsByCategory()method. Click “Finish”. This will allow the DropDownList to act as a “trigger” that will tell the ProductDataSource to supply new data to the GridView.</p></li><li><p>Click the GridView’s smart tag and select the ProductDataSource in the “Choose Data Source” drop-down. Notice how the GridView automatically “discovers” the kind of data (Products) that is supplied by the ObjectDataSource control and then creates columns for each property of the Product class.</p></li><li><p>Test the form in a browser window. When you select a category and click the LinkButton, the page will perform a post-back and the GridView will be refreshed with new data. Notice that there is no code-behind in the form to populate the DropDownList or the GridView. That is because the ObjectDataSource controls do all of that work for us.</p></li></ol><p>Making the Form User Friendly<br>
There are a number of things that can be done to make the form more user-friendly, including<br>
•	Add “Select a Category” to the top of the DropDownList, to let the user know how to use the form<br>
•	Change column headings in the GridView<br>
•	Convert Foreign Key values/columns to DropDownLists (to show text instead of a number)<br>
The DropDownList</p><ol><li><p>Click the smart tag on the DropDownList for selecting a category, and click “Edit Items…”. This opens the ListItem Collection Editor, where we can manually add items to the DropDownList.</p></li><li><p>Add a manual item with a display text of “[Select a category]” and a value of negative one (-1). Click OK.</p></li><li><p>Set the AppendDataBoundItems property of the DropDownList to true.</p></li></ol><p>The GridView’s Columns and Headings</p><ol><li><p>In the Design view of the form, click the GridView’s smart tag and select “Edit Columns…”.</p></li><li><p>In the Fields dialog, click on CategoryID from the list of selected fields. Then click the Delete Column button.</p></li><li><p>Click ProductID from the list of selected fields. Then, in the list of properties for this field, change the HeaderText to “ID”.</p></li><li><p>Continue modifying the header text of the columns until your GridView looks a follows.</p></li></ol><p>Empty Data Template</p><ol><li><p>Click “Edit Templates” in the GridView’s smart tag. This puts the GridView into Template Editing Mode.</p></li><li><p>Choose the EmptyDataTemplate to edit and enter the text “There are no products for the selected category.”</p></li></ol><p>Template Columns for Foreign Keys - SupplierID</p><ol><li><p>Once again, click the GridView’s smart tag and select “Edit Columns…”. This time, select the column for the Supplier and click the “Convert this field into a TemplateField” link.</p></li><li><p>Add an ObjectDataSource control to the form and give it an ID of “SupplierDataSource”. Select “Configure Data Source” from the smart tag. This will open the Configure Data Source wizard.</p></li><li><p>In the first step of the wizard, select NorthwindSystem.BLL.SupplierController as the business object. Then click “Next”.</p></li><li><p>For the Select method, choose ListAllSuppliers(). Then click “Finish”.</p></li><li><p>From the GridView’s smart tag, select “Edit Templates”. Then select the Item Template for the Supplier.</p></li><li><p>Remove the Label control from the Item Template. Replace it with a DropDownList control and give that control an ID of SupplierItem.</p></li><li><p>Click the smart tag of the DropDownList and select “Choose Data Source…”.</p></li><li><p>In the Data Source Configuration Wizard, select the SupplierDataSource from the drop down. Then select “CompanyName” as the field to display and “SupplierID” as the field for the value of the DropDownList. Click OK.</p></li><li><p>Again, from the smart tag of the DropDownList, click on “Edit DataBindings…”.</p></li><li><p>For the SelectedValue property of the DropDownList, choose Field binding and have it bound to the SupplierID of the GridView’s data. This will allow the DropDownList control in the Supplier column of the GridView to synchronize its selected item with the actual supplier for each row in the GridView. Click OK when finished.</p></li><li><p>Choose “Edit Items…” from the smart tag of the DropDownList.</p></li><li><p>Add an item with a display text of “[no supplier]”. Click OK.</p></li><li><p>Select the Source or Split view of the form. Go to the “[no supplier]” ListItem for this DropDownList and change the Value attribute to an empty string. We need an empty string value for any Products whose SupplierID property is null.<br>
(Note that this change to the ListItem must actually be done in the source of the web form and not from the ListItem Collection Editor. That’s because if you try to simply empty the Value property in the ListItem Collection Editor, it will remove the Value attribute. This has a different effect from keeping the Value attribute and setting it to an empty string.)</p></li><li><p>In the Properties window for the DropDownList, set the AppendDataBoundItems to true. Also set the Enabled property to false and change the ForeColor to “Black”.</p></li><li><p>Test the form in the browser. Selecting a category of products should fill the GridView with data in a more readable format.</p></li></ol><p>Part 4 – TextBox and Data-Bound GridView<br>
This part of the tutorial walks through the steps to create a form that will look up Products based on a partial product name. Once again, there is no code-behind in the form to populate the GridView. That is because the ObjectDataSource controls do all of that work for us.</p><ol><li><p>In the Admin folder of the web site, create a new web form called “SearchProducts.aspx”. Design the form to look like the following screen shot. Give the TextBox an ID of “PartialProductName”. Also add a LinkButton to the form.</p></li><li><p>Add an ObjectDataSource control to the form. Give it an ID of ProductDataSource.</p></li><li><p>Click the smart tag for the ProductDataSource and select “Configure Data Source”. This will open a wizard control that will simplify hooking up this control to the Business Logic Layer of our application.</p></li><li><p>In the “Choose a Business Object” page of the wizard, make sure the “Show only data components” check box is selected. Choose the NorthwindSystem.BLL.ProductController class as the Business Object that will supply data for this control. Then click “Next”.</p></li><li><p>In the “Define Data Methods” page of the wizard, select the LookupProductsByName() method as the SELECT method for the control. Then click “Next”.</p></li><li><p>In the “Define Parameters” page of the wizard, we must identify the PartialProductName TextBox as the control that supplies the value for the partialName parameter of the LookupProductsByName() method. Click “Finish”.</p></li><li><p>Add a GridView control and give it the ID “FoundProducts”. Click the GridView’s smart tag and select the ProductDataSource in the Choose Data Source drop-down. The GridView will use that ObjectDataSource control to create columns for each property of the Product class.</p></li><li><p>In the GridView’s smart tag click “Edit Columns…”. Modify the columns to modify headings and display only the columns shown in the screen shot.</p></li><li><p>Edit the GridView’s EmptyDataTemplate to show the text “No Matching Products”.</p></li><li><p>Test the form in a browser window. When you enter a partial product name and click the LinkButton, the page will perform a post-back and the GridView will be refreshed with new data.</p></li></ol><p>Summary<br>
In this hands-on tutorial, you discovered how through the use of the ObjectDataSource control, it is possible to display data in a form through GridView and DropDownList controls without needing any code-behind in the web form.<br>
Discussion Points<br>
The following questions are designed to help you review key aspects of this tutorial<br>
To Be Continued<br>
•	Why we need to set Value=”” in the Source view of the form for ListItems in DropDownList controls (for null values).<br>
•	Postback triggers the ObjectDataSource to repopulate the GridView (Parts 2, 3 and 4)<br>
•</p><p>Using DataBound Controls (Tutorial 7b of 9)<br>
Hands-On Tutorials for Application Programming 1 (DMIT152)<br>
Contents at a Glance<br>
Introduction	1<br>
Using Data Bound Controls	2</p><p>Detailed Contents<br>
Introduction	1<br>
Using Data Bound Controls	2<br>
Purpose	2<br>
Setup	2<br>
Part 5 – Synchronizing Two GridViews	3<br>
Part 6 – Enabling Paging in GridViews	4<br>
Summary	4<br>
Discussion Points	4</p><p>Introduction<br>
This series of hands-on tutorials are designed to demonstrate how to build a web application that uses a Client-Server architecture and that persists information in a database. Each tutorial will walk the reader through steps to build upon a specific web application scenario based upon the Northwind Traders database.<br>
There are nine tutorials in this package. Each hands-on tutorial has a Starter Kit folder with all of the required material to begin the tutorial and a Solution folder with the final product of the tutorial.<br>
Using Data Bound Controls<br>
•	Estimated time: 15-30 minutes.<br>
•	Bonus Parts:<br>
o	Part 5 – Synchronizing Two GridViews<br>
ViewCategoriesAndProducts<br>
o	Part 6 – Enabling Paging in GridViews<br>
ManageProducts<br>
Purpose<br>
This hands-on tutorial walks through how to further customize the display of data in GridView controls. Data is made available to the form through the use of ObjectDataSource controls. (The ObjectDataSource control acts as a “middle-man” in exchanging data between your BLL and various Data Bound controls, such as the GridView and DropDownList.)<br>
Setup<br>
For this lab, you will need the Visual Studio solution and database from the previous topic(s). The Starter Kit folder contains these resources.<br>
Part 5 – Synchronizing Two GridViews<br>
This part of the tutorial walks through the steps to create a form that will look up Products by Supplier. Suppier information will be displayed in a GridView; selecting a row in the Supplier GridView will trigger the Products GridView to show all the products provided through that supplier. Once again, there is no code-behind in the form to populate the GridViews.<br>
Sketch of Form</p><ol><li>In the Admin folder of the web site, create a new web form called “”. Design the form to look like the following screen shot. Add two GridView controls; give the top GridView an ID of “” and the bottom an ID of “”.<br>
form</li><li>Add two ObjectDataSource controls to the form. Give them the IDs of ProductDataSource and SupplierDataSource.<br>
Form</li><li>Configure the SupplierDataSource to use the NorthwindSystem.BLL.SupplierController class as the Business Object that will supply data for this control. Then click “Next”.<br>
wizard</li><li>In the “Define Data Methods” page of the wizard, select the ListAllSuppliers() method as the SELECT method for the control. Then click “Finish”.<br>
wizard</li><li>Set the SupplierDataSource as the data source for the ??? GridView.<br>
dialog/smart tag</li><li>In the smart tag of the ??? GridView, check on the Enable Select checkbox.<br>
Smart tag</li><li>Configure the ProductDataSource to use the NorthwindSystem.BLL.ProductController class as the Business Object that will supply data for this control. Then click “Next”.<br>
wizard</li><li>In the “Define Data Methods” page of the wizard, select the LookupBySupplier() method as the SELECT method for the control. On the next page, set the ??? GridView as the control which identifies which supplier the user has selected.<br>
wizard</li><li>In the ??? page of the wizard, we must identify the ??_?? TextBox as the control that supplies the value for the CategoryID parameter of the LookupBySupplier () method. Also set a default value of zero (0), which will be needed when the page is first loaded. Click “Finish”.<br>
wizard</li><li>Set the ProductDataSource as the data source for the ??? GridView.<br>
dialog/smart tag</li><li>Through the ??? GridView’s smart tag, edit the EmptyDataTemplate to state that “There are no products for the selected supplier.”<br>
form w. SmartTag</li><li>Edit the columns for both GridViews to match the headings/styles of the screen shot below.<br>
form</li><li>Test the form in a browser window. When you click the “Select” link beside any given supplier, the page will perform a post-back and the related products will be displayed in the second GridView.<br>
browser<br>
Part 6 – Enabling Paging in GridViews</li><li>In the web site, open the “” web form. On the smart tag for the ??? GridView, click on “Enable Paging”.<br>
web form and smart tag</li><li>Test the form in the browser. Try navigating from one page of Product data to another.<br>
browser</li><li>In the web site, open the “” web form. Enable paging for the GridView on this form as well. Test this form in a browser as well.<br>
web form<br>
Summary<br>
In this hands-on tutorial, you SUMMARY.<br>
Discussion Points<br>
The following questions are designed to help you review key aspects of this tutorial<br>
•	Why we need to set Value=”” in the Source view of the form for ListItems in DropDownList controls (for null values).<br>
•	Postback triggers the ObjectDataSource to repopulate the GridView (Parts 2, 3 and 4)<br>
•</li></ol></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/3.7fdc53a7.js" defer></script><script src="/assets/js/app.b01b77a3.js" defer></script>
  </body>
</html>
