<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lesson Plan: Day 2 | CPSC-1517 Student Notes</title>
    <meta name="description" content="Introduction to Application Development">
    
    
    <link rel="preload" href="/assets/css/0.styles.80f4b4fc.css" as="style"><link rel="preload" href="/assets/js/app.18ca0063.js" as="script"><link rel="preload" href="/assets/js/82.30b15df6.js" as="script"><link rel="prefetch" href="/assets/js/15.68dc8e9d.js"><link rel="prefetch" href="/assets/js/1.9613adf6.js"><link rel="prefetch" href="/assets/js/2.9378c4ec.js"><link rel="prefetch" href="/assets/js/3.971e86a2.js"><link rel="prefetch" href="/assets/js/4.f6208d11.js"><link rel="prefetch" href="/assets/js/5.5af9712a.js"><link rel="prefetch" href="/assets/js/6.43cc925b.js"><link rel="prefetch" href="/assets/js/7.23ab461f.js"><link rel="prefetch" href="/assets/js/8.f5420ce6.js"><link rel="prefetch" href="/assets/js/9.57aecd33.js"><link rel="prefetch" href="/assets/js/10.ec6ae9c3.js"><link rel="prefetch" href="/assets/js/11.f57f4b4c.js"><link rel="prefetch" href="/assets/js/12.b1eb4f61.js"><link rel="prefetch" href="/assets/js/13.3aa1d2e6.js"><link rel="prefetch" href="/assets/js/14.e130c5b8.js"><link rel="prefetch" href="/assets/js/16.65ca882c.js"><link rel="prefetch" href="/assets/js/17.295eeab3.js"><link rel="prefetch" href="/assets/js/18.db61e7e8.js"><link rel="prefetch" href="/assets/js/19.2ea1010b.js"><link rel="prefetch" href="/assets/js/20.f4159ad9.js"><link rel="prefetch" href="/assets/js/21.b6c17dd6.js"><link rel="prefetch" href="/assets/js/22.9919b407.js"><link rel="prefetch" href="/assets/js/23.b0bbc267.js"><link rel="prefetch" href="/assets/js/24.046a81c3.js"><link rel="prefetch" href="/assets/js/25.6a9003d0.js"><link rel="prefetch" href="/assets/js/26.b6d3cee7.js"><link rel="prefetch" href="/assets/js/27.97f57c46.js"><link rel="prefetch" href="/assets/js/28.c6e59545.js"><link rel="prefetch" href="/assets/js/29.809ebd4f.js"><link rel="prefetch" href="/assets/js/30.dc025023.js"><link rel="prefetch" href="/assets/js/31.69b7baf3.js"><link rel="prefetch" href="/assets/js/32.3260e839.js"><link rel="prefetch" href="/assets/js/33.59ca40ec.js"><link rel="prefetch" href="/assets/js/34.869ffff0.js"><link rel="prefetch" href="/assets/js/35.caa30fd0.js"><link rel="prefetch" href="/assets/js/36.ff53776b.js"><link rel="prefetch" href="/assets/js/37.82ced42f.js"><link rel="prefetch" href="/assets/js/38.df0ba7ba.js"><link rel="prefetch" href="/assets/js/39.86af542f.js"><link rel="prefetch" href="/assets/js/40.f32adf72.js"><link rel="prefetch" href="/assets/js/41.d579ee77.js"><link rel="prefetch" href="/assets/js/42.783ab02b.js"><link rel="prefetch" href="/assets/js/43.437cfda1.js"><link rel="prefetch" href="/assets/js/44.6ac4edc2.js"><link rel="prefetch" href="/assets/js/45.f1db196f.js"><link rel="prefetch" href="/assets/js/46.9465cc30.js"><link rel="prefetch" href="/assets/js/47.1c476926.js"><link rel="prefetch" href="/assets/js/48.c21960ec.js"><link rel="prefetch" href="/assets/js/49.d87eda7a.js"><link rel="prefetch" href="/assets/js/50.017f75e8.js"><link rel="prefetch" href="/assets/js/51.4315db19.js"><link rel="prefetch" href="/assets/js/52.c4508db7.js"><link rel="prefetch" href="/assets/js/53.80132b99.js"><link rel="prefetch" href="/assets/js/54.c08ed4bd.js"><link rel="prefetch" href="/assets/js/55.a92ccd93.js"><link rel="prefetch" href="/assets/js/56.9e0d7bca.js"><link rel="prefetch" href="/assets/js/57.e5b7372e.js"><link rel="prefetch" href="/assets/js/58.6b02135a.js"><link rel="prefetch" href="/assets/js/59.6400a0a4.js"><link rel="prefetch" href="/assets/js/60.dbb6edbb.js"><link rel="prefetch" href="/assets/js/61.7754624d.js"><link rel="prefetch" href="/assets/js/62.3cea0c67.js"><link rel="prefetch" href="/assets/js/63.481ce7d1.js"><link rel="prefetch" href="/assets/js/64.7e17d71d.js"><link rel="prefetch" href="/assets/js/65.efe4bee6.js"><link rel="prefetch" href="/assets/js/66.2f2c0486.js"><link rel="prefetch" href="/assets/js/67.b0f157e1.js"><link rel="prefetch" href="/assets/js/68.f1628f2f.js"><link rel="prefetch" href="/assets/js/69.002b01fc.js"><link rel="prefetch" href="/assets/js/70.cf8495d1.js"><link rel="prefetch" href="/assets/js/71.7c6eceaa.js"><link rel="prefetch" href="/assets/js/72.3939ffad.js"><link rel="prefetch" href="/assets/js/73.ecfc97a3.js"><link rel="prefetch" href="/assets/js/74.d910aa50.js"><link rel="prefetch" href="/assets/js/75.b8972ba7.js"><link rel="prefetch" href="/assets/js/76.8b7f61ba.js"><link rel="prefetch" href="/assets/js/77.39c2e61c.js"><link rel="prefetch" href="/assets/js/78.f07ab13f.js"><link rel="prefetch" href="/assets/js/79.99522ab3.js"><link rel="prefetch" href="/assets/js/80.91bb7e9e.js"><link rel="prefetch" href="/assets/js/81.64e3f368.js"><link rel="prefetch" href="/assets/js/83.b785f80f.js"><link rel="prefetch" href="/assets/js/84.9d3042a6.js"><link rel="prefetch" href="/assets/js/85.d20b6dc7.js">
    <link rel="stylesheet" href="/assets/css/0.styles.80f4b4fc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      CPSC-1517 Student Notes
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/about/" class="nav-link">Home</a></div><div class="nav-item"><a href="/logs/" class="nav-link">LOGs</a></div><div class="nav-item"><a href="/csharp/" class="nav-link">C-Sharp</a></div><div class="nav-item"><a href="/html/" class="nav-link">Html</a></div><div class="nav-item"><a href="/razor/" class="nav-link">Razor</a></div><div class="nav-item"><a href="/clientserver/" class="nav-link">Client-Server</a></div><div class="nav-item"><a href="/webforms/" class="nav-link">Webforms</a></div><div class="nav-item"><a href="https://cpsc-1517.github.io/LabSpecs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lab Specs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/CPSC-1517/CPSC-1517.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/about/" class="nav-link">Home</a></div><div class="nav-item"><a href="/logs/" class="nav-link">LOGs</a></div><div class="nav-item"><a href="/csharp/" class="nav-link">C-Sharp</a></div><div class="nav-item"><a href="/html/" class="nav-link">Html</a></div><div class="nav-item"><a href="/razor/" class="nav-link">Razor</a></div><div class="nav-item"><a href="/clientserver/" class="nav-link">Client-Server</a></div><div class="nav-item"><a href="/webforms/" class="nav-link">Webforms</a></div><div class="nav-item"><a href="https://cpsc-1517.github.io/LabSpecs/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Lab Specs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/CPSC-1517/CPSC-1517.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Issues/Bugs
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://moodle.nait.ca" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Moodle
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><ul class="sidebar-links"><li><a href="/Instructor/" class="sidebar-link">Lesson Plan Overview</a></li></ul></div><div class="page"><div class="content"><p><strong>Objectives:</strong></p><p><strong>Discuss:</strong></p><blockquote><p>What is EntityFramework?</p></blockquote><blockquote><p>Client Server Architecture (logical n-tiered): WebApp: configuration setup</p></blockquote><blockquote><p>Client Server Architecture (logical n-tiered): NorthwindEntities library:<br>
Entity Classes.</p></blockquote><blockquote><p>Client Server Architecture (logical n-tiered): NorthwindSystem library:<br>
Context class.</p></blockquote><p><strong>Code:</strong></p><blockquote><p>Setup EntityFramework: class entities, context class and configuration<br>
files.</p></blockquote><p><strong>Resources: Student</strong></p><p>Moodle site.</p><p>URL Student Notes</p><p>Client Server Architecture</p><p><strong>Resources: Instructor</strong></p><p>Lesson 2: Introduction to EnityFramework.</p><p><strong>Concepts:</strong></p><ol><li><p>What is EntityFramework</p></li><li><p>Where does it “sit” in our logical Client Server Architecture.</p></li><li><p>Mapping of sql table to entity class: use of annotations</p></li></ol><p><strong>EntityFramework: Data Access</strong></p><p>When ASP.Net first started, users used ADO.Net to access the database. This<br>
required mounts of work, redundant setup work. As time went on, as usual, 3rd<br>
party individuals attempted to reduce the amount of work needed to access the<br>
database using ADO.Net. One popular library was Enterprise Library. This reduce<br>
the redundant tedious work of using ADO.net directly. In about 2008, Microsoft<br>
introduce EntityFramework to assist developers with database access. ADO.Net was<br>
even further removed from developer (hidden). EntityFramework is a set of<br>
classes that manage your database access. One links into EntityFramework via<br>
inheriting its DBContext class. Using the DBSet&lt;T&gt; of this context class<br>
(where &lt;T&gt; is an entity definition class) and properly annotated entity<br>
definition class, database CRUD management has been greatly simplified. <strong>In<br>
this course, the entity definition classes will be coded manually by the student<br>
so they can get a better understanding of the components needed by<br>
EnityFramework. Do not reverse engineer the entities. This will be covered in<br>
DMIT2018.</strong></p><p><a href="https://en.wikipedia.org/wiki/Entity_Framework" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Entity_Framework<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><a href="http://www.entityframeworktutorial.net/what-is-entityframework.aspx" target="_blank" rel="noopener noreferrer">http://www.entityframeworktutorial.net/what-is-entityframework.aspx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p><strong>EntityFramework in logical Client Server Architecture</strong></p><p>EntityFramework will manage the access of data to and from the database (aqua<br>
color). The DAL layer will contain a class which will be referred to as the<br>
Context class. This class will inherit DbContext from EntityFramework. The<br>
commands to query, add, update and delete records will be coded in the BLL<br>
classes using the DAL Context Class. The mapping of the sql tables will be done<br>
in the Entity classes of the Entity library. These entity classes will be used<br>
by the DAL, BLL and PL layers. These classes are data definitions of the sql<br>
tables.</p><p><img src="/assets/img/65a79bacad56128241e52332894cdcf0.65a79bac.png" alt></p><p><strong>Coding: Create Entity class</strong></p><p>When creating your entity class, you are mapping a sql table to a set of<br>
properties. The basics of objects does not change. You usually have public<br>
properties (private data members if fully implemented) and constructors. What<br>
you also have is annotations that are used to assist in the mapping. There are<br>
some defaults. Example the [Key] annotation is place with the property that is<br>
mapped to the primary key of the sql database. If the name of the property is<br>
the same as the name of the sql attribute AND that attribute ends in Id or ID,<br>
the [Key] annotation is not needed. If the primary key is an identity attribute,<br>
then no other parameters are need for the [Key] annotation.</p><p>Required <strong>using</strong> Namespace statements:</p><p>#region Additional Namespaces</p><p>using System.ComponentModel.DataAnnotations.Schema;</p><p>using System.ComponentModel.DataAnnotations;</p><p>#endregion</p><p>Common Annotations:</p><blockquote><p>[Table(“sql tablename”,Schema=“sql schemaname”)]</p></blockquote><blockquote><p>The Table annotation is placed before the public class classname. Use to map<br>
sql table to the class entity definition. If the sql database does not have<br>
subschemas then the ,Schema(“sql schemaname’) is not needed. If you wish to<br>
use it, use dbo as the schemaname.</p></blockquote><blockquote><p>[Table(“myTable”)] or [Table(“myTable”,Schema=“Sales”)]</p></blockquote><blockquote><p>public class myTable{….. public class myTable{…..</p></blockquote><p>[Key, Column(Order=n),DatabaseGenerated(DatabaseGeneratedOption.xxxxxx]</p><blockquote><p>The [Key] annotation is place with the property that is mapped to the<br>
primary key of the sql database. If the name of the property is the same as<br>
the name of the sql attribute AND that attribute ends in Id or ID, the [Key]<br>
annotation is not needed. If the primary key is an identity attribute, then<br>
no other parameters are need for the [Key] annotation. The Column parameter<br>
is used if the primary key is a compound key. Each property making up the<br>
compound key needs an annotation. The Order=n starts at 1 (logical count<br><strong>not</strong> index) and positions the order of the properties to the order of the<br>
compound key. The DatabaseGenerated parameter is used to identify the field<br>
type of the sql attribute key. Xxxxxx can be Computed, Identity or None. The<br>
Identity option is the default. If your sql pkey is an identity key, you do<br>
not have to use this parameter. None indicates the user will supply the pkey<br>
value. Computed is used if the sql attribute is a computed attribute.</p></blockquote><blockquote><p>[Key] ( a sql identity primary key with a name ending in ID or Id)</p></blockquote><blockquote><p>public int myIdentityPkeyID{ get; set; }</p></blockquote><blockquote><p>[Key,Column(Order=1)] (a compound primary key of 2 attributes)</p></blockquote><blockquote><p>public int firstCompoundPFkeyID{ get; set; }</p></blockquote><blockquote><p>[Key,Column(Order=2)]</p></blockquote><blockquote><p>public int secondCompoundPFkeyID{ get; set; }</p></blockquote><blockquote><p>[Key,DatabaseGenerated(DatabaseGeneratedOption.None)]<br>
( a sql user supplied primary key)</p></blockquote><blockquote><p>public int myIdentityPkeyID{ get; set; }</p></blockquote><p>[DatabaseGenerated(DatabaseGeneratedOption.Computed]</p><blockquote><p>If you have a computed sql attribute, place the DatabaseGenerated annotation<br>
before it. This will map the property to the attribute but also indicate<br>
that on DML insert and update no value will be supplied by the user. Assume<br>
the sql attribute Total is computed using GST and SubTotal.</p></blockquote><blockquote><p>public decimal SubTotal { get; set;}</p></blockquote><blockquote><p>public decimal GST { get; set;}</p></blockquote><blockquote><p>[DatabaseGenerated(DatabaseGeneratedOption.Computed] (no value from user)</p></blockquote><blockquote><p>public decimal Total { get; set;}</p></blockquote><blockquote><p>[ForeignKey(“tablename”)] (<strong>do not use unless necessary</strong>)</p></blockquote><blockquote><p>The foreign key annotation is only necessary if the sql foreign key<br>
attribute name is different than the sql primary key name. If the FKey name<br>
is the same as the PKey name do not use this attribute.</p></blockquote><blockquote><p>[ForeignKey(“pkeytablename”)]</p></blockquote><blockquote><p>public int differentFKeyPkeyname { get; set;}</p></blockquote><blockquote><p>[NotMapped]</p></blockquote><blockquote><p>This attribute is used for properties that exist in the definition class<br>
that are not directly associated with an sql table attribute. A typical<br>
usage is for a read-only property such as Name (a concatenation of FirstName<br>
and LastName attributes).</p></blockquote><blockquote><p>[NotMapped]</p></blockquote><blockquote><p>public string Name { get { return LastName + “, “ + FirstName}}</p></blockquote><p><strong>Entity:Products</strong></p><p>This entity has an optional Schema= coded. The property names <strong>match</strong> the sql<br>
attribute names. The property names <strong>do not</strong> need to be in the same order as<br>
the sql attributes <strong>if</strong> the property names match the sql attribute names.<br><strong>If</strong> the names <strong>do not</strong> match then the <strong>physical order</strong> of the properties<br>
are mapped to the <strong>physical order</strong> of the sql attributes. The only not null<br>
attributes are ProductID and ProductName on the sql table. Thus, the datatypes<br>
in the entity require the ? mark (except for strings). <strong>Our</strong> coding standard<br>
will be to use the <strong>singular name</strong> for the entity definition.</p><p>using System;</p><p>using System.Collections.Generic;</p><p>using System.Linq;</p><p>using System.Text;</p><p>using System.Threading.Tasks;</p><p>#region Additional Namespaces</p><p>using System.ComponentModel.DataAnnotations.Schema;</p><p>using System.ComponentModel.DataAnnotations;</p><p>#endregion</p><p>namespace NorthwindSystem</p><p>{</p><p>[Table(&quot;Products&quot;,Schema =&quot;dbo&quot;)]</p><p>public class Product</p><p>{</p><p>private string _QuanityPerUnit;</p><p>[Key]</p><p>public int ProductID { get; set; }</p><p>public string ProductName { get; set; }</p><p>public int? SupplierID { get; set; }</p><p>public int? CategoryID { get; set; }</p><p>public string QuantityPerUnit</p><p>{</p><p>get</p><p>{</p><p>return _QuanityPerUnit;</p><p>}</p><p>set</p><p>{</p><p>if(string.IsNullOrEmpty(value))</p><p>{</p><p>_QuanityPerUnit = null;</p><p>}</p><p>else</p><p>{</p><p>_QuanityPerUnit = value;</p><p>}</p><p>}</p><p>}</p><p>public decimal? UnitPrice { get; set; }</p><p>public Int16? UnitsInStock { get; set; }</p><p>public Int16? UnitsOnOrder { get; set; }</p><p>public Int16? ReorderLevel { get; set; }</p><p>public bool Discontinued { get; set; }</p><p>}</p><p>}</p><p><strong>Coding: Create DAL Context class</strong></p><p>The DAL Context is where we connect to EntityFramework. This is done by having<br>
our Context class inherit DbContext from EntityFramework. The constructor of our<br>
context class will pass the name of our sql connectionstring to EntityFramework.<br>
References to the tables in sql are done by using DbSet&lt;T&gt; where &lt;T&gt; is one<br>
of the entity definition classes. The DbSet is the datatype of a public property<br>
in our context class. These property names will be a plural version of the<br>
entity definition class name. Our context class access will be <strong>internal</strong> to<br>
force users of the NorthwindSystem library to access the library via the BLL<br>
methods. Right click on the DAL folder and add a class called<br><strong>NorthwindContext</strong>. Note the required using statements: NorthwindEntities (for<br>
entity definitions) and System.Data.Entity for obtaining necessary<br>
EntityFramework references.</p><p>NorthwindSystem.DAL.NorthwindContext:</p><p>using System;</p><p>using System.Collections.Generic;</p><p>using System.Linq;</p><p>using System.Text;</p><p>using System.Threading.Tasks;</p><p>#region Additional Namespaces</p><p>using System.Data.Entity;</p><p>using Northwind.Data.Entities;</p><p>#endregion</p><p>namespace NorthwindSystem.DAL</p><p>{</p><p>internal class NorthwindContext:DbContext</p><p>{</p><p>public NorthwindContext():base(&quot;NWDB&quot;)</p><p>{</p><p>}</p><p>public DbSet&lt;Product&gt; Products { get; set; }</p><p>}</p><p>}</p><p><strong>Coding: Configuration setup</strong></p><p>The DAL Context is where we connect to the connectionstring for our database. On<br>
the context class constructor is a base reference to the connectionstring name.<br>
This name will be passed to EntityFramework when an instance of the context<br>
class is generated. We need to set up the connectionstring. The connectionstring<br>
could be setup in the exitings Web.config file but we will setup a separate<br>
config file for all connectionstrings and reference the new file in the<br>
Web.config file. This will allow us to alter any connection string without<br>
possibly damaging any of the other configuration values of the web site.</p><ul><li><p>Right click WebSite, select Add/Add New Item.. and scroll down until you<br>
file Web Configuration file.</p></li><li><p>Select and name the file <strong>WebConnectionStrings</strong>.</p></li><li><p>Delete the current contents of this new file.</p></li><li><p>Open the Web.Config file.</p></li><li><p>Locate the &lt;connectionStrings&gt; tag, select and copy the tag.</p></li><li><p>Return to the WebConnectionStrings file and paste.</p></li><li><p>Add the following under the existing &lt;add&gt; tag</p></li></ul><p>&lt;add name=&quot;NWDB&quot;</p><p>connectionString=&quot;Data Source=.; Initial Catalog=Northwind_CPSC1517; Integrated<br>
Security=true&quot;</p><p>providerName=&quot;System.Data.SqlClient&quot;/&gt;</p><ul><li>Return to the Web.config file and replace the &lt;connectionStrings&gt; tag with</li></ul><p>&lt;connectionStrings configSource=&quot;WebConnectionStrings.config&quot; /&gt;</p><p>EntityFramework likes to be helpful by creating tables for the application. When<br>
you created the entity definition, one of the annotations was<br>
[Table(“tablename”)]. If the tablename does not exist in the database,<br>
EntityFramework will create the table using your entity definition as the layout<br>
for the table when you initially execute the web application. Naturally, this<br>
will prevent any abort of a missing object (sql table). However, your new table<br>
will have no data. This can cause confusion as there is no abort but no data,<br>
and you probably say to yourself…Ughhhhhhh! Why!!.</p><p>To avoid this situation, you can add a new tag to the web.config file. By adding<br>
this new tag, you will prevent EntityFramework from dynamically creating new<br>
tables for you. Thus, if you do mistype the tablename in the entity definition<br>
and that tablename does not exits in the database, you will end up getting what<br>
you actually expect: an error stating this is <strong>an invalid object</strong> (the missing<br>
table).</p><ul><li><p>Open the web.config file</p></li><li><p>Scroll down to the &lt;entityFramework&gt; tag</p></li><li><p>Enter the following new tag</p></li></ul><blockquote><p>&lt;contexts&gt;</p></blockquote><blockquote><p>&lt;context disableDatabaseInitialization=&quot;true&quot;</p></blockquote><blockquote><p>type=&quot;NorthwindSystem.DAL.NorthwindContext,NorthwindSystem&quot;&gt;</p></blockquote><blockquote><p>&lt;/context&gt;</p></blockquote><blockquote><p>&lt;/contexts&gt;</p></blockquote><p>The Type parameter has two values. The first is the fully qualified class name<br>
for the context class. A fully qualified class name consists of the<br>
namespace.classname (NorthwindSystem.DAL followed by the classname<br>
.NorthwindContext). The second parameter is the assembly name for your library<br>
which is typically the project name.</p><p>One problem that I normally see is the students create their projects then<br>
realize the project name is incorrect (or just not what they wanted). The<br>
student will try to rename the project using (r/c Rename). This does not change<br>
the original assembly name. To change the assembly name you need to r/c your<br>
project library name and select Properties. This will open a window to show you<br>
the current Assembly Name and Namespace. You (the student) can then alter the<br>
values to their new desired value. It is also wise to check under the button<br>
Assembly Information…</p><p><img src="/assets/img/d747f816502f9396b33c1d568705b4c9.d747f816.png" alt></p><p>To ensure that the corrected assembly name is in-effect, I suggest the student<br>
open the Bin folder of the Website and locate the library dlls for Northwind<br>
(NorthwindEntities.dll, NorthwindEntities.pcb, NorthwindSystem.dll, and<br>
NorthwindSystem.pcb). Select these files and delete them. Now do a ReBuild of<br>
the Solution.</p><p>Another problem that arises with this &lt;context&gt; tag is typos. Assume the<br>
follow typo of the assembly name: NrthwindSystem (instead of NorthwindSystem) in<br>
the web.config file. The solution is to fix the typo.</p><p><img src="/assets/img/a00adc7c499c407d8a4b03ee492d8557.a00adc7c.png" alt></p><p>Exercise:</p><p>As an exercise, have your students create the entity definitions for the<br>
Suppliers and Categories sql tables. Have them update the context class with<br>
appropriate DbSet&lt;T&gt;. In Categories for Picture use byte[] and for<br>
PictureMimeType use string.</p></div><div class="page-edit"><!----><!----></div><!----></div></div></div>
    <script src="/assets/js/82.30b15df6.js" defer></script><script src="/assets/js/app.18ca0063.js" defer></script>
  </body>
</html>
