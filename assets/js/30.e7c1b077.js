(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{281:function(e,t,r){"use strict";r.r(t);var s=r(0),i=Object(s.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"content"},[r("p",[r("strong",[e._v("Objectives:")])]),r("p",[r("strong",[e._v("Discuss:")])]),r("blockquote",[r("p",[e._v("What is “filter” searching?")])]),r("blockquote",[r("p",[e._v("Why would one wish to use a filter search?")])]),r("blockquote",[r("p",[e._v("Different filter searching techniques. (Review Basic Search Techniques under"),r("br"),e._v("\nRazor Forms and Database Queries)")])]),r("p",[r("strong",[e._v("Code:")])]),r("blockquote",[r("p",[e._v("BLL: Introduce the use of Views in sql as the data container for"),r("br"),e._v("\nSqlQuery<T>().")])]),r("blockquote",[r("p",[e._v("PL: Use different controls to obtain the search filter and display the"),r("br"),e._v("\nsearch data.")])]),r("p",[r("strong",[e._v("Resources: Student")])]),r("p",[e._v("Moodle site.")]),r("ul",[r("li",[r("p",[e._v("Search Techniques")])]),r("li",[r("p",[e._v("Display Multiple Items in a GridView (tutorial)")])])]),r("p",[r("strong",[e._v("Resources: Instructor")])]),r("p",[e._v("Lesson 1: Review of filter search techniques first shown in Razor.")]),r("p",[r("strong",[e._v("Concepts:")])]),r("ol",[r("li",[r("p",[e._v("Filter search Techniques")])]),r("li",[r("p",[e._v("Why and When to use filter search techniques")])]),r("li",[r("p",[e._v("Relate to Course Project")])]),r("li",[r("p",[e._v("Optional Menu and MultiView")])])]),r("p",[r("strong",[e._v("Class actions:")])]),r("p",[e._v("Demo the FilterSearches.aspx page.")]),r("p",[e._v("Menu and MultiView controls.")]),r("p",[e._v("MultiView")]),r("p",[e._v('<asp:MultiView ID="MultiView1" runat="server" ActiveViewIndex="0">')]),r("p",[e._v('<asp:View ID="View1" runat="server">')]),r("p",[e._v('<fieldset class="form-horizontal">')]),r("p",[e._v("<legend>Filter Queries: Dropdown List</legend>")]),r("p",[e._v('<asp:Label ID="Label1" runat="server" Text="Categories:"></asp:Label>')]),r("p",[e._v('<asp:DropDownList ID="CategoryList" runat="server"')]),r("p",[e._v('AutoPostBack="True" OnSelectedIndexChanged="CategoryList_SelectedIndexChanged">')]),r("p",[e._v("</asp:DropDownList>")]),r("p",[e._v("<br /><br />")]),r("p",[e._v('<asp:GridView ID="ProductGridViewV1" runat="server">')]),r("p",[e._v("</asp:GridView>")]),r("p",[e._v("</fieldset>")]),r("p",[e._v("</asp:View>")]),r("p",[e._v('<asp:View ID="View2" runat="server">')]),r("ul",[r("li",[e._v("Repeat asp:View for each view tab")])]),r("p",[e._v("</asp:View>")]),r("p",[e._v("</asp:MultiView>")]),r("p",[r("strong",[e._v("Notes")])]),r("p",[e._v('ActiveViewIndex="0" Parameter indicates which view to show on the web page, set'),r("br"),e._v("\nto the first view (index 0) when the page is first displayed. This parameter can"),r("br"),e._v("\nbe changed in your code behind to see the other views (see Menu).")]),r("p",[e._v('<asp:View ID="View1" runat="server"> Starts a view. The view contains whatever'),r("br"),e._v("\ncontrols you wish to use to create your display")]),r("p",[e._v('AutoPostBack="True" On the DropDownList means a button is not required. The'),r("br"),e._v("\nevent is activated if the selected item on the list is changed.")]),r("p",[e._v("It is important to note that this is ALL one web page. The rules of unique names"),r("br"),e._v("\non a web page MUST be followed even though similar controls may exist in other"),r("br"),e._v("\nviews (example the GridView). You cannot reuse the same name. One simple"),r("br"),e._v("\nsolution is to add a string to the name to make it unique. This page adds Vn to"),r("br"),e._v("\nthe end of command named controls where n is the view number (1,2, etc) ex:"),r("br"),e._v("\nProductGridViewV1.")]),r("p",[r("strong",[e._v("Menu")])]),r("p",[e._v("The Menu control is used to represent the tabs of the MultiView. The Menu is"),r("br"),e._v("\nformatted using a custom CSS file. The event is used to switch between Views.")]),r("p",[r("strong",[e._v("CSS")])]),r("p",[e._v(".tabs{")]),r("p",[e._v("position:relative;")]),r("p",[e._v("top:1px;")]),r("p",[e._v("left:10px;")]),r("p",[e._v("}")]),r("p",[e._v(".tab{")]),r("p",[e._v("border:solid 3px black;")]),r("p",[e._v("background-color:white;")]),r("p",[e._v("padding: 5px 10px;")]),r("p",[e._v("}")]),r("p",[e._v(".selectedTab {")]),r("p",[e._v("background-color: white;")]),r("p",[e._v("border-bottom:solid 3px white;")]),r("p",[e._v("}")]),r("p",[e._v(".tabContents {")]),r("p",[e._v("border: solid 1px black;")]),r("p",[e._v("padding: 10px;")]),r("p",[e._v("background-color: white")]),r("p",[e._v("}")]),r("p",[r("strong",[e._v("Menu control")])]),r("p",[e._v('<asp:Menu ID="Menu1" runat="server" Orientation="Horizontal"')]),r("p",[e._v('StaticMenuItemStyle-CssClass="tab"')]),r("p",[e._v('Font-Size="Large" StaticSelectedStyle-CssClass="selectedTab"')]),r("p",[e._v('StaticMenuItemStyle-HorizontalPadding="50px"')]),r("p",[e._v('StaticSelectedStyle-BackColor="lightblue"')]),r("p",[e._v('CssClass="tabs"')]),r("p",[e._v('OnMenuItemClick="Menu1_MenuItemClick">')]),r("p",[e._v("<Items>")]),r("p",[e._v('<asp:MenuItem Text="DropDownList" Selected="true" Value="0"></asp:MenuItem>')]),r("p",[e._v('<asp:MenuItem Text="Textbox" Value="1"></asp:MenuItem>')]),r("p",[e._v('<asp:MenuItem Text="MultiParameter" Value="2"></asp:MenuItem>')]),r("p",[e._v('<asp:MenuItem Text="DrillDown" Value="3"></asp:MenuItem>')]),r("p",[e._v('<asp:MenuItem Text="Exercise" Value="4"></asp:MenuItem>')]),r("p",[e._v("</Items>")]),r("p",[e._v("</asp:Menu>")]),r("p",[e._v("The Value parameter will be used by the event to set the ActiveviewIndex.")]),r("p",[r("strong",[e._v("Menu Event")])]),r("p",[e._v("protected void Menu1_MenuItemClick(object sender, MenuEventArgs e)")]),r("p",[e._v("{")]),r("p",[e._v("int index = Int32.Parse(e.Item.Value);")]),r("p",[e._v("MultiView1.ActiveViewIndex = index;")]),r("p",[e._v("}")]),r("p",[e._v("Demo different types of filters. Search Techniques document. Relate to course"),r("br"),e._v("\nproject.")]),r("p",[r("strong",[e._v("Using SQL Views")])]),r("p",[e._v("There are times when your application may not need the complete entity class"),r("br"),e._v("\ndefinition or the returned data does not match the entity class definition. Sql"),r("br"),e._v("\nviews are popular way of exposing data to a user so they are not directly"),r("br"),e._v("\ntouching the sql table. You can create a class that models the data returned by"),r("br"),e._v("\na View. This class will NOT have a DbSet() in the context class. It CAN be used"),r("br"),e._v("\nas the datatype for a <T> collection.")]),r("p",[e._v("This page has 2 Views:")]),r("p",[e._v("EmployeeOfTerritory (demo page DrillDown)")]),r("p",[e._v("//this is not a database table (entity)")]),r("p",[e._v("//this is a definition of a database view, DO NOT create a DbSet<> for this"),r("br"),e._v("\nclass")]),r("p",[e._v("public class EmployeeOfTerritory")]),r("p",[e._v("{")]),r("p",[e._v("public string TerritoryID { get; set; }")]),r("p",[e._v("public int EmployeeID { get; set; }")]),r("p",[e._v("public string FirstName { get; set; }")]),r("p",[e._v("public string LastName { get; set; }")]),r("p",[e._v("public string Address { get; set; }")]),r("p",[e._v("public string City { get; set; }")]),r("p",[e._v("public string PostalCode { get; set; }")]),r("p",[e._v("public string HomePhone { get; set; }")]),r("p",[e._v("public string Extension { get; set; }")]),r("p",[e._v("[NotMapped]")]),r("p",[e._v("public string FullName")]),r("p",[e._v("{")]),r("p",[e._v("get")]),r("p",[e._v("{")]),r("p",[e._v('return LastName + ", " + FirstName;')]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("SupplierCategories (Exercise view).")]),r("p",[e._v("public class SupplierCategories")]),r("p",[e._v("{")]),r("p",[e._v("public int CategoryID {get;set;}")]),r("p",[e._v("public string CategoryName { get; set; }")]),r("p",[e._v("}")]),r("p",[r("strong",[e._v("Exercise View")])]),r("p",[e._v("This is for the student to do as a class exercise. It is not for marks.")]),r("p",[e._v("Solution:")]),r("p",[e._v('<asp:View ID="View5" runat="server">')]),r("p",[e._v('<fieldset class="form-horizontal">')]),r("p",[e._v("<legend>Filter Queries: Exercise</legend>")]),r("p",[e._v('<blockquote style="font-size:x-large">')]),r("p",[e._v("For this exercise (not for marks) you are to retrieve the products")]),r("p",[e._v("from a supplier's category and display the product(s) records. You need to")]),r("p",[e._v("create the necessary controller methods, design your form, and implement")]),r("p",[e._v("the necessary code-behind. The following resources are available for this"),r("br"),e._v("\nexercise:")]),r("p",[e._v("<ul>")]),r("p",[e._v("<li>Sql procedure <strong> Suppliers_GetCategories</strong>: returns the"),r("br"),e._v("\nsupplier's categories</li>")]),r("p",[e._v("<li>Sql procedure <strong>Products_GetForSupplierCategory</strong>:"),r("br"),e._v("\nreturns"),r("br"),e._v("\nproducts for a supplier category</li>")]),r("p",[e._v("<li>Entities and Views: <strong>Product, Supplier, SupplierCategories"),r("br"),e._v("\n</strong></li>")]),r("p",[e._v("</ul>")]),r("p",[e._v("</blockquote>")]),r("p",[e._v('<asp:Label ID="Label7" runat="server" Text="Supplier:"></asp:Label>')]),r("p",[e._v('<asp:DropDownList ID="SupplierListV5" runat="server"></asp:DropDownList>')]),r("p",[e._v('<asp:Button ID="FindCategories" runat="server" Text="Categories?"'),r("br"),e._v('\nOnClick="FindCategories_Click" />')]),r("p",[e._v('<asp:Label ID="label8" runat="server" Text="Categories:"></asp:Label>')]),r("p",[e._v('<asp:DropDownList ID="CategoryListV5" runat="server"></asp:DropDownList>')]),r("p",[e._v('<asp:Button ID="FindSupplierCategoryProducts" runat="server" Text="Products?"')]),r("p",[e._v('OnClick="FindSupplierCategoryProducts_Click" Enabled="false" />')]),r("p",[e._v('<asp:Button ID="Reset" runat="server" Text="Reset" OnClick="Reset_Click" />')]),r("p",[e._v("<br />")]),r("p",[e._v("<br />")]),r("p",[e._v('<asp:GridView ID="ProductsGridViewV5" runat="server">')]),r("p",[e._v("</asp:GridView>")]),r("p",[e._v("</fieldset>")]),r("p",[e._v("</asp:View>")]),r("p",[e._v("protected void FindCategories_Click(object sender, EventArgs e)")]),r("p",[e._v("{")]),r("p",[e._v("if (SupplierListV5.SelectedIndex == 0)")]),r("p",[e._v("{")]),r("p",[e._v('errormsgs.Add("Select a supplier to obtain their categories.");')]),r("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-info");')]),r("p",[e._v("CategoryListV5.Items.Clear();")]),r("p",[e._v("ProductsGridViewV5.DataSource = null;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("}")]),r("p",[e._v("else")]),r("p",[e._v("{")]),r("p",[e._v("try")]),r("p",[e._v("{")]),r("p",[e._v("SupplierController sysmgr = new SupplierController();")]),r("p",[e._v("List<SupplierCategories> info ="),r("br"),e._v("\nsysmgr.Suppliers_GetCategories(int.Parse(SupplierListV5.SelectedValue));")]),r("p",[e._v("if (info.Count == 0)")]),r("p",[e._v("{")]),r("p",[e._v('errormsgs.Add("No category data found for the supplier");')]),r("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-info");')]),r("p",[e._v("CategoryListV5.Items.Clear();")]),r("p",[e._v("CategoryListV5.DataBind();")]),r("p",[e._v("ProductsGridViewV5.DataSource = null;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("}")]),r("p",[e._v("else")]),r("p",[e._v("{")]),r("p",[e._v("info.Sort((x, y) => x.CategoryName.CompareTo(y.CategoryName));")]),r("blockquote",[r("p",[e._v("//Second Dropdown list drill down")])]),r("p",[e._v("CategoryListV5.DataSource = info;")]),r("p",[e._v("CategoryListV5.DataTextField = nameof(SupplierCategories.CategoryName);")]),r("p",[e._v("CategoryListV5.DataValueField = nameof(SupplierCategories.CategoryID);")]),r("p",[e._v("CategoryListV5.DataBind();")]),r("p",[e._v('CategoryListV5.Items.Insert(0, "select....");')]),r("p",[e._v("//GridView")]),r("p",[e._v("ProductsGridViewV5.DataSource = null;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("SupplierListV5.Enabled = false;")]),r("p",[e._v("FindSupplierCategoryProducts.Enabled = true;")]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("catch (Exception ex)")]),r("p",[e._v("{")]),r("p",[e._v("errormsgs.Add(GetInnerException(ex).ToString());")]),r("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-danger");')]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("protected void FindSupplierCategoryProducts_Click(object sender, EventArgs e)")]),r("p",[e._v("{")]),r("p",[e._v("if (CategoryListV5.SelectedIndex == 0)")]),r("p",[e._v("{")]),r("p",[e._v('errormsgs.Add("Select a category to view the supplier\'s category products.");')]),r("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-info");')]),r("p",[e._v("ProductsGridViewV5.DataSource = null;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("}")]),r("p",[e._v("else")]),r("p",[e._v("{")]),r("p",[e._v("try")]),r("p",[e._v("{")]),r("p",[e._v("ProductController sysmgr = new ProductController();")]),r("p",[e._v("List<Product> info = sysmgr.Products_GetForSupplierCategory(")]),r("p",[e._v("int.Parse(SupplierListV5.SelectedValue),")]),r("p",[e._v("int.Parse(CategoryListV5.SelectedValue));")]),r("p",[e._v("if (info.Count == 0)")]),r("p",[e._v("{")]),r("p",[e._v('errormsgs.Add("No data found for the supplier\'s category");')]),r("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-info");')]),r("p",[e._v("ProductsGridViewV5.DataSource = null;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("}")]),r("p",[e._v("else")]),r("p",[e._v("{")]),r("p",[e._v("info.Sort((x, y) => x.ProductName.CompareTo(y.ProductName));")]),r("p",[e._v("//GridView")]),r("p",[e._v("ProductsGridViewV5.DataSource = info;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("catch (Exception ex)")]),r("p",[e._v("{")]),r("p",[e._v("errormsgs.Add(GetInnerException(ex).ToString());")]),r("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-danger");')]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("protected void Reset_Click(object sender, EventArgs e)")]),r("p",[e._v("{")]),r("p",[e._v("SupplierListV5.Enabled = true;")]),r("p",[e._v("CategoryListV5.Items.Clear();")]),r("p",[e._v("FindSupplierCategoryProducts.Enabled = false;")]),r("p",[e._v("//GridView")]),r("p",[e._v("ProductsGridViewV5.DataSource = null;")]),r("p",[e._v("ProductsGridViewV5.DataBind();")]),r("p",[e._v("}")]),r("p",[e._v("SupplierController")]),r("p",[e._v("public List<SupplierCategories> Suppliers_GetCategories(int suppilerid)")]),r("p",[e._v("{")]),r("p",[e._v("using (var context = new NorthwindContext())")]),r("p",[e._v("{")]),r("p",[e._v("IEnumerable<SupplierCategories> results ="),r("br"),e._v("\ncontext.Database.SqlQuery<SupplierCategories>("),r("br"),e._v('\n"Suppliers_GetCategories @SupplierID",')]),r("p",[e._v('new SqlParameter("SupplierID", suppilerid));')]),r("p",[e._v("return results.ToList();")]),r("p",[e._v("}")]),r("p",[e._v("}")]),r("p",[e._v("ProductController")]),r("p",[e._v("public List<Product> Products_GetForSupplierCategory(int supplierid, int"),r("br"),e._v("\ncategoryid)")]),r("p",[e._v("{")]),r("p",[e._v("using (var context = new NorthwindContext())")]),r("p",[e._v("{")]),r("p",[e._v("IEnumerable<Product> results =")]),r("p",[e._v("context.Database.SqlQuery<Product>("),r("br"),e._v('\n"Products_GetForSupplierCategory @SupplierID, @CategoryID",')]),r("p",[e._v('new SqlParameter("SupplierID", supplierid),')]),r("p",[e._v('new SqlParameter("CategoryID", categoryid));')]),r("p",[e._v("return results.ToList();")]),r("p",[e._v("}")]),r("p",[e._v("}")])])}],!1,null,null,null);i.options.__file="lesson-2.md";t.default=i.exports}}]);