(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{455:function(e,t,a){"use strict";a.r(t);var i=a(42),r=Object(i.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[a("strong",[e._v("Objectives:")])]),e._v(" "),a("p",[a("strong",[e._v("Discuss:")])]),e._v(" "),a("p",[e._v("Using SqlQuery and SqlParameter")]),e._v(" "),a("blockquote",[a("p",[e._v("Why would one wish to customize their GridView presentation?")])]),e._v(" "),a("blockquote",[a("p",[e._v("Generally accepted practise for alignment and data formatting.")])]),e._v(" "),a("blockquote",[a("p",[e._v("GridView customized components Template columns.")])]),e._v(" "),a("p",[a("strong",[e._v("Code:")])]),e._v(" "),a("blockquote",[a("p",[e._v("PL: Customize a GridView using Template columns.")])]),e._v(" "),a("p",[a("strong",[e._v("Resources: Student")])]),e._v(" "),a("p",[e._v("Moodle site.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Displaying Mutliple Items in a GridView")])]),e._v(" "),a("li",[a("p",[e._v("Customizing GridView")])]),e._v(" "),a("li",[a("p",[e._v("Working with GridView Events")])])]),e._v(" "),a("p",[a("strong",[e._v("Resources: Instructor")])]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Lesson 1:")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("Displaying Mutliple Items in a GridView")])]),e._v(" "),a("li",[a("p",[e._v("Customizing GridView,")])]),e._v(" "),a("li",[a("p",[e._v("Working with GridView Events")])])])])]),e._v(" "),a("p",[a("strong",[e._v("Concepts:")])]),e._v(" "),a("ol",[a("li",[a("p",[e._v("Calling an sql procedure from the BLL")])]),e._v(" "),a("li",[a("p",[e._v("Boundfields vs Template fields")])]),e._v(" "),a("li",[a("p",[e._v("Customizing techniques (IDE vs self coding)")])]),e._v(" "),a("li",[a("p",[e._v("Customize format of data.")])]),e._v(" "),a("li",[a("p",[e._v("Customize general appearance of GridView")])])]),e._v(" "),a("p",[a("strong",[e._v("Class actions:")])]),e._v(" "),a("p",[e._v("Do the Customizing Gridview tutorial.")]),e._v(" "),a("p",[a("strong",[e._v("Lesson Notes:")])]),e._v(" "),a("p",[e._v("A developer does not need to just rely on queries to a single sql table using\n.List() or .Find(). You can call a sql procedure using SqlQuery<T>(). You can\npass parameters to the call using SqlParameter(). The SqlParameter needs the\nSystem.Data.SqlClient name space.")]),e._v(" "),a("p",[e._v("Open the ProductController. Add the following method.")]),e._v(" "),a("p",[e._v("//to query your database using a non primary key value")]),e._v(" "),a("p",[e._v("//this will require a sql procedure to call")]),e._v(" "),a("p",[e._v("//the namespace System.Data.SqlClient is required")]),e._v(" "),a("p",[e._v("//the returning datatype is IEnumerable<T>")]),e._v(" "),a("p",[e._v("//this returning datatype will be cast using ToList() on the return")]),e._v(" "),a("p",[e._v("public List<Product> Products_GetByPartialProductName(string partialname)")]),e._v(" "),a("p",[e._v("{")]),e._v(" "),a("p",[e._v("using (var context = new NorthwindContext())")]),e._v(" "),a("p",[e._v("{")]),e._v(" "),a("p",[e._v("//sometimes there may be a sql error that does not like the new SqlParameter()")]),e._v(" "),a("p",[e._v("// coded directly in the SqlQuery call")]),e._v(" "),a("p",[e._v("//if this happens to you then code your parameter as shown below then")]),e._v(" "),a("p",[e._v("// use the parm1 in the SqlQuery call instead of the new....")]),e._v(" "),a("p",[e._v("//don't know why but its weird")]),e._v(" "),a("p",[e._v('//var parm1 = new SqlParameter("PartialName", partialname);')]),e._v(" "),a("p",[e._v("IEnumerable<Product> results = context.Database.SqlQuery<Product>"),a("br"),e._v('\n("Products_GetByPartialProductName @PartialName",')]),e._v(" "),a("p",[e._v('new SqlParameter("PartialName", partialname));')]),e._v(" "),a("p",[e._v("return results.ToList();")]),e._v(" "),a("p",[e._v("}")]),e._v(" "),a("p",[e._v("}")]),e._v(" "),a("p",[e._v("The dataset that is returned to the method from sql is an IEnumerable<T>. The\ndatatype T will be a designed object that matches the design of the SELECT\ncommand of your procedure (this example uses Product). The call does not use the\nDbSet() entity, instead is via .Database.SqlQuery<T>(). It will still use your\ncontext class. The parameters of the method consists of the procedure name with\nany passed parameters as a string followed by a set of SqlParameter() instances,\none each for each parameter.")]),e._v(" "),a("p",[e._v("The example uses the procedure Products_GetBySupplierPartialProductName.\nREMEMBER, you are coding in C# so case-sensitivity is important. The first\nparameter to SqlQuery<T>() is the calling of the procedure using the procedure\nname and any necessary procedure parameters. Notice that the sql parameters\nstart with an @ and must match the case and spelling of the parameter in the\nprocedure. If there are more than one parameter, separate these using a comma\n(,). If there are any parameters to the sql procedure, these are supplied\nfollowing the first SqlQuery parameter. The procedure parameters are supplied as\nSqlParameter instances. The instance requires 2 parameters: a string identifying\nthe sql procedure parameter and a value. Notice the @ is removed from the\nstring. If you have multiple SqlParameter instances, separate them by a comma\n(,).")]),e._v(" "),a("p",[a("strong",[e._v("GridView")])]),e._v(" "),a("p",[e._v("GridView replaced the DataGrid as a web control in Framework 2.0. The DataGrid\ncontrol does not appear on the Framework 2.0 toolbar. The workings of the\nGridView and DataGrid appear to be extremely similar with only a couple minor\ndifferences.")]),e._v(" "),a("p",[e._v("The GridView is used to display multiple rows from a data source, typically a\ndatatable. The datatable may be standalone or within a dataset. The default\ndisplay of the datatable within the gridview uses all the table columns and the\ntable column name as the gridview column header. This poses a problem if you\nwish to display specific columns, use alternate column headings or assign\ndisplay formats that differ from the basic string display of the data.")]),e._v(" "),a("p",[e._v("We will discuss two popular techniques used in customizing a gridview,\nBoundFields and Templates. The BoundField is generally used for read-only\ndisplays. The default display format is string. You can assign various\nformatting patterns to your data. When used with the EditUpdate command button,\nthe BoundField will be displayed within a textbox. The Template column allows\nfor a more refined customization of the gridview column. There are several types\nof template columns: ItemTemplate, EditItemTemplate, AlternatingItemTemplate,\nHeaderTemplate and FooterTemplate. You must supply the content display or a\nbasic standard web control (such as textbox, drop down list, checkbox) when\nsetting up a template. Access to data is done using script.")]),e._v(" "),a("p",[e._v("You may have a combination of boundfields and template columns within a single\ngridview, each representing a different column. When you do customize your\ngridview, set the AutoGenerateColumn property to “false” (default is “true”) or\nyou will get "),a("strong",[e._v("both")]),e._v(" your customized columns and the default set column setup.")]),e._v(" "),a("p",[e._v("A gridview is ideally used when your data source has 3 or more columns to\ndisplay for multiple rows. If you have only 2 columns (description and an\nassociated value), consider using a drop down list. Your columns should have\nlimited size and any particular column data should not wrap to the following\nline.")]),e._v(" "),a("p",[e._v("Review Customizing GridView and Working with GridView events documents.")]),e._v(" "),a("p",[e._v("Concentrate on template fields as they are the most versatile (sample).")]),e._v(" "),a("p",[e._v('<asp:GridView ID="ProductGridView" runat="server"')]),e._v(" "),a("blockquote",[a("p",[e._v('AutoGenerateColumns="False" GridLines="None"')])]),e._v(" "),a("p",[e._v('AllowPaging="True" PageSize="2"')]),e._v(" "),a("p",[e._v('OnPageIndexChanging="ProductGridView_PageIndexChanging"')]),e._v(" "),a("p",[e._v('OnSelectedIndexChanged="ProductGridView_SelectedIndexChanged">')]),e._v(" "),a("p",[e._v("<Columns>")]),e._v(" "),a("p",[e._v('<asp:CommandField CausesValidation="False" SelectText="View"')]),e._v(" "),a("p",[e._v('ShowSelectButton="True"></asp:CommandField>')]),e._v(" "),a("p",[e._v("<asp:TemplateField >")]),e._v(" "),a("p",[e._v("<ItemTemplate>")]),e._v(" "),a("p",[e._v('<asp:Label ID="ProductID" runat="server"')]),e._v(" "),a("p",[e._v('Text=\'<%# Eval("ProductID") %>\' Visible="false"></asp:Label>')]),e._v(" "),a("p",[e._v("</ItemTemplate>")]),e._v(" "),a("p",[e._v("</asp:TemplateField>")]),e._v(" "),a("p",[e._v('<asp:TemplateField HeaderText="Name">')]),e._v(" "),a("p",[e._v("<ItemTemplate>")]),e._v(" "),a("p",[e._v('<asp:Label ID="ProductName" runat="server"')]),e._v(" "),a("p",[e._v('Text=\'<%# Eval("ProductName") %>\'Width="300px"></asp:Label>')]),e._v(" "),a("p",[e._v("</ItemTemplate>")]),e._v(" "),a("p",[e._v('<HeaderStyle HorizontalAlign="Left"></HeaderStyle>')]),e._v(" "),a("p",[e._v('<ItemStyle HorizontalAlign="Left"></ItemStyle>')]),e._v(" "),a("p",[e._v("</asp:TemplateField>")]),e._v(" "),a("p",[e._v('<asp:TemplateField HeaderText="Qty/Unit">')]),e._v(" "),a("p",[e._v("<ItemTemplate>")]),e._v(" "),a("p",[e._v('<asp:Label ID="QuantityPerUnit" runat="server"')]),e._v(" "),a("p",[e._v('Text=\'<%# Eval("QuantityPerUnit") %>\' Width="200px"></asp:Label>')]),e._v(" "),a("p",[e._v("</ItemTemplate>")]),e._v(" "),a("p",[e._v('<ItemStyle HorizontalAlign="Left"></ItemStyle>')]),e._v(" "),a("p",[e._v("</asp:TemplateField>")]),e._v(" "),a("p",[e._v('<asp:TemplateField HeaderText="$">')]),e._v(" "),a("p",[e._v("<ItemTemplate>")]),e._v(" "),a("p",[e._v('<asp:Label ID="UnitPrice" runat="server"')]),e._v(" "),a("p",[e._v('Text=\'<%# string.Format("{0:0.00}", Eval("UnitPrice")) %>\'')]),e._v(" "),a("p",[e._v('Width="50px"></asp:Label>')]),e._v(" "),a("p",[e._v("</ItemTemplate>")]),e._v(" "),a("p",[e._v('<ItemStyle HorizontalAlign="Right"></ItemStyle>')]),e._v(" "),a("p",[e._v("</asp:TemplateField>")]),e._v(" "),a("p",[e._v('<asp:TemplateField HeaderText="Disc">')]),e._v(" "),a("p",[e._v("<ItemTemplate>")]),e._v(" "),a("p",[e._v('<asp:CheckBox ID="Discontinued" runat="server"')]),e._v(" "),a("p",[e._v("Checked='<%# Eval(\"Discontinued\") %>' />")]),e._v(" "),a("p",[e._v("</ItemTemplate>")]),e._v(" "),a("p",[e._v('<ItemStyle HorizontalAlign="Center"></ItemStyle>')]),e._v(" "),a("p",[e._v("</asp:TemplateField>")]),e._v(" "),a("p",[e._v("</Columns>")]),e._v(" "),a("p",[e._v("<EmptyDataTemplate>")]),e._v(" "),a("p",[e._v("No products from for search criteria")]),e._v(" "),a("p",[e._v("</EmptyDataTemplate>")]),e._v(" "),a("p",[e._v('<PagerSettings FirstPageText="Start" LastPageText="End" Mode="NumericFirstLast"'),a("br"),e._v('\nPageButtonCount="5" />')]),e._v(" "),a("p",[e._v("</asp:GridView>")]),e._v(" "),a("p",[e._v("Points of interest:")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("GridLines=”None”: removes gridlines from display")])]),e._v(" "),a("li",[a("p",[e._v("EmptyDataTemplate: should be included in any gridview to handle an empty\nassigned dataset")])]),e._v(" "),a("li",[a("p",[e._v("Paging: Parameters created for you when setting the control properties")])]),e._v(" "),a("li",[a("p",[e._v("CausesValidation: if your page contains validation controls and you do not\nwant to have the validation to run when pressing the command button on your\ngridview.")])]),e._v(" "),a("li",[a("p",[e._v("Visible=”false’: to hid a column but still have it available for event\nprocessing")])]),e._v(" "),a("li",[a("p",[e._v("Formatting using string.Format()")])]),e._v(" "),a("li",[a("p",[e._v("Command button event")])]),e._v(" "),a("li",[a("p",[e._v("Paging event")])])]),e._v(" "),a("p",[e._v("protected void ProductGridView_SelectedIndexChanged(object sender, EventArgs e)")]),e._v(" "),a("p",[e._v("{")]),e._v(" "),a("p",[e._v("//optional")]),e._v(" "),a("p",[e._v("//create a variable line pointer to the GridView Selected Row")]),e._v(" "),a("p",[e._v("GridViewRow agvrow = ProductGridView.Rows[ProductGridView.SelectedIndex];")]),e._v(" "),a("p",[e._v("//extract the data from the GridView Row column")]),e._v(" "),a("p",[e._v("//the data will be retrieved as a string")]),e._v(" "),a("p",[e._v('//to find the control on the row use the .FindControl("idname")')]),e._v(" "),a("p",[e._v("//to determine the type of control referenced use as ControlTypeName")]),e._v(" "),a("p",[e._v("//to access the data use the control's appropriate access technique")]),e._v(" "),a("p",[e._v('string productid = (agvrow.FindControl("ProductID") as Label).Text;')]),e._v(" "),a("p",[e._v('string productname = (agvrow.FindControl("ProductName") as Label).Text;')]),e._v(" "),a("p",[e._v('string quantityperunit = (agvrow.FindControl("QuantityPerUnit") as Label).Text;')]),e._v(" "),a("p",[e._v('string unitprice = (agvrow.FindControl("UnitPrice") as Label).Text;')]),e._v(" "),a("p",[e._v('bool discontinued = (agvrow.FindControl("Discontinued") as CheckBox).Checked;')]),e._v(" "),a("p",[e._v('string msg = string.Format("Id: {0} Name: {1} Qty/Unit: {2} $: {3} Disc: {4}",')]),e._v(" "),a("p",[e._v("productid, productname, quantityperunit, unitprice, discontinued);")]),e._v(" "),a("p",[e._v("errormsgs.Add(msg);")]),e._v(" "),a("p",[e._v('LoadMessageDisplay(errormsgs, "alert alert-success");')]),e._v(" "),a("p",[e._v("}")]),e._v(" "),a("p",[e._v("protected void ProductGridView_PageIndexChanging(object sender,\nGridViewPageEventArgs e)")]),e._v(" "),a("p",[e._v("{")]),e._v(" "),a("p",[e._v("//set the new page number on the gridview")]),e._v(" "),a("p",[e._v("//the adjustment of the page number IS NOT automatic")]),e._v(" "),a("p",[e._v("ProductGridView.PageIndex = e.NewPageIndex;")]),e._v(" "),a("p",[e._v("//refresh the gridview by requering the database")]),e._v(" "),a("p",[e._v("SearchProducts_Click(sender, e);")]),e._v(" "),a("p",[e._v("}")])])}),[],!1,null,null,null);t.default=r.exports}}]);